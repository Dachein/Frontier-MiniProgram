<view class="container {{currentStyle}}">
  
  <!-- 1. 顶部风格导航 -->
  <view class="style-tabs">
    <view wx:for="{{styles}}" wx:key="id" 
          class="tab-item {{item.id === currentStyle ? 'active' : ''}}"
          bindtap="scrollToStyle" data-index="{{index}}">
      <view class="tab-dot"></view>
      <text class="tab-text" wx:if="{{item.id === currentStyle}}">{{item.name}}</text>
    </view>
  </view>

  <!-- 2. 核心：全屏 Swiper 预览 -->
  <swiper class="style-swiper" 
          current="{{currentIndex}}" 
          bindchange="onSwiperChange"
          duration="300"
          easing-function="easeInOutCubic">
    <swiper-item wx:for="{{styles}}" wx:key="id">
      <scroll-view scroll-y class="preview-scroll" show-scrollbar="{{false}}" enhanced="{{true}}">
        <view class="image-container">
          <view wx:if="{{!styleImages[item.id]}}" class="image-placeholder">
            <view class="spinner"></view>
            <text>正在洗照片...</text>
          </view>
          <image wx:else 
                 src="{{styleImages[item.id]}}" 
                 mode="widthFix" 
                 class="preview-image"
                 show-menu-by-longpress></image>
        </view>
        <view style="height: 300rpx;"></view>
      </scroll-view>
    </swiper-item>
  </swiper>

  <!-- 3. 悬浮胶囊工具栏 - 使用内联图标类名 -->
  <view class="floating-toolbar">
    <view class="tool-btn" bindtap="handleMoments">
      <view class="btn-icon icon-moments"></view>
      <text>朋友圈</text>
    </view>
    <view class="divider"></view>
    
    <button class="tool-btn-native" open-type="share">
      <view class="btn-icon icon-forward"></view>
      <text>好友/群</text>
    </button>
    
    <view class="divider"></view>
    
    <view class="tool-btn highlight" bindtap="handleSave">
      <view class="btn-icon icon-save-image"></view>
      <text>保存相册</text>
    </view>
  </view>

  <!-- 4. 离屏 Canvas (后台工作) -->
  <view class="offscreen-box">
    <canvas wx:for="{{styles}}" wx:key="id" 
            type="2d" 
            id="canvas-{{item.id}}" 
            style="width: 750px; height: 2000px;"></canvas>
  </view>
</view>
